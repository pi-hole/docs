<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../../images/favicon.png">
  
  <title>Connecting clients - Pi-hole documentation</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Connecting clients";
    var mkdocs_page_input_path = "guides\\vpn\\clients.md";
    var mkdocs_page_url = "/guides/vpn/clients/";
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js"></script>
  <script src="../../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> Pi-hole documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../../..">Support</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Getting Started</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../main/prerequesites/">Prerequisites</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../main/basic-install/">Installation</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../main/post-install/">Post-Install</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Guides</span>
    <ul class="subnav">
                <li class=" current">
                    
    <span class="caption-text">Pi-hole and OpenVPN Server</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../overview/">Overview</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../installation/">Installation</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../setup-openvpn-server/">Setup OpenVPN Server</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../firewall/">Firewall Configuration</a>
                </li>
                <li class="toctree-l3 current">
                    
    <a class="current" href="./">Connecting clients</a>
    <ul class="subnav">
            
    <li class="toctree-l4"><a href="#connect-from-a-client">Connect from a client</a></li>
    

    <li class="toctree-l4"><a href="#android">Android</a></li>
    

    <li class="toctree-l4"><a href="#linux">Linux</a></li>
    

    <li class="toctree-l4"><a href="#windows">Windows</a></li>
    

    <li class="toctree-l4"><a href="#optional-add-more-client-certificates">Optional: Add more client certificates</a></li>
    

    </ul>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../only-dns-via-vpn/">Optional: Only route DNS via VPN</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../dual-operation/">Optional: Dual operation: LAN & VPN at the same time</a>
                </li>
    </ul>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">Pi-hole documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../..">Docs</a> &raquo;</li>
    
      
        
          <li>Guides &raquo;</li>
        
      
        
          <li>Pi-hole and OpenVPN Server &raquo;</li>
        
      
    
    <li>Connecting clients</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/pi-hole/docs/edit/master/docs/guides/vpn/clients.md"> Edit on pi-hole/docs</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p><strong>See bottom of this page for how to generate additional client certificates</strong></p>
<h3 id="connect-from-a-client">Connect from a client</h3>
<p>There are various tutorials available for all operating systems for how to connect to an OpenVPN server.</p>
<h3 id="android">Android</h3>
<p>See special page <a href="https://github.com/pi-hole/pi-hole/wiki/OpenVPN-server:-Connect-from-a-client-(Android)">here</a>.</p>
<h3 id="linux">Linux</h3>
<p>I'll demonstrate the procedure here for Ubuntu Linux (which trivially extends to Linux Mint, etc.)</p>
<ol>
<li>Install the necessary network-manager plugins</li>
</ol>
<pre><code>sudo apt-get install network-manager-openvpn network-manager-openvpn-gnome
sudo service network-manager restart
</code></pre>

<ol>
<li>Securely copy the necessary certificates from your OpenVPN server to your client (e.g. using <code>sftp</code>). They are located in <code>/etc/openvpn/easy-rsa/pki</code></li>
</ol>
<p>You will need:</p>
<ul>
<li>User Certificate: <code>/etc/openvpn/easy-rsa/pki/issued/client.crt</code></li>
<li>CA Certificate: <code>/etc/openvpn/easy-rsa/pki/ca.crt</code></li>
<li>Private Key: <code>/etc/openvpn/easy-rsa/pki/private/client.key</code></li>
<li>Private Key Password: Depending on your settings (might even be empty)</li>
<li>TA Key: <code>/etc/openvpn/ta.key</code></li>
</ul>
<p>Further details can be found in the screenshots provided below:
<img alt="" src="http://www.dl6er.de/pi-hole/openVPN/conn_type.png" />
<img alt="" src="http://www.dl6er.de/pi-hole/openVPN/keys.png" />
<img alt="" src="http://www.dl6er.de/pi-hole/openVPN/general.png" />
<img alt="" src="http://www.dl6er.de/pi-hole/openVPN/security.png" />
<img alt="" src="http://www.dl6er.de/pi-hole/openVPN/tls.png" /></p>
<p>Your whole network traffic will now securely be transferred to your Pi-hole.
<img alt="" src="http://www.dl6er.de/pi-hole/openVPN/VPNclients.png" /></p>
<h3 id="windows">Windows</h3>
<p>You will have to install additional software. See https://openvpn.net/index.php/open-source/downloads.html</p>
<hr />
<h3 id="optional-add-more-client-certificates">Optional: Add more client certificates</h3>
<p>You have to generate an individual certificate for each client. This can be done very conveniently like shown below:
<pre>
<b>sudo bash openvpn-install.sh</b></p>
<p>Looks like OpenVPN is already installed</p>
<p>What do you want to do?
   <b>1) Add a new user</b>
   2) Revoke an existing user
   3) Remove OpenVPN
   4) Exit
Select an option [1-4]: <b>1</b></p>
<p>Tell me a name for the client certificate
Please, use one word only, no special characters
Client name: thinkpad2
Generating a 2048 bit RSA private key
.......................+++
....+++
writing new private key to '/etc/openvpn/easy-rsa/pki/private/thinkpad2.key.kHwbBkvK9b'</p>
<hr />
<p>Using configuration from /etc/openvpn/easy-rsa/openssl-1.0.cnf
Check that the request matches the signature
Signature ok
The Subject's Distinguished Name is as follows
commonName            :ASN.1 12:'thinkpad2'
Certificate is to be certified until Feb 28 10:24:26 2027 GMT (3650 days)</p>
<p>Write out database with 1 new entries
Data Base Updated</p>
<p><b>Client thinkpad2 added, configuration is available at /root/thinkpad2.ovpn</b>
</pre>
Copy the file <code>/root/thinkpad2.ovpn</code> to your new client.</p>
<p><strong>WARNING</strong> Anyone who gets his hands on this configuration/certificate file can obtain full access to your VPN. Make sure that you use only trusted paths for transferring the file (e.g. <em>never</em> send it via an un-encrypted channel, e.g. email or FTP). Best strategy is to use an USB thumbdrive to avoid any network transport at all. Make sure to delete the certificate on the USB drive afterwards.</p>
<p><strong>NOTICE</strong> If one of your certificates has been compromised, remove it using option <code>2</code> (see above) and generate a new certificate. This will effectively lock out anyone who might have gotten access to the certificate.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../only-dns-via-vpn/" class="btn btn-neutral float-right" title="Optional: Only route DNS via VPN">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../firewall/" class="btn btn-neutral" title="Firewall Configuration"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>Copyright &copy; 2017 Pi-hole LLC</p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../firewall/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../only-dns-via-vpn/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme.js"></script>
      <script src="../../../search/require.js"></script>
      <script src="../../../search/search.js"></script>

</body>
</html>
